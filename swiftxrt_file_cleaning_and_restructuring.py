# -*- coding: utf-8 -*-
"""SwiftXRT_File_Cleaning_And_Restructuring.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cTjELOdbIutx3hbWic2Dj8pa7Q65_HMz
"""

import re
import decimal
import pandas as pd
import warnings
import os
warnings.filterwarnings("ignore")

head, filename = os.path.split("/content/flux_plain_2.dat")

with open(filename) as file:
  data = file.read()

data

def is_number(s):
    try:
        float(s)
        return True
    except ValueError:
        return False

filenew = open(filename,'w+')

Cols = ['!Time','T_+ve','T_-ve','Flux','Fluxpos','Fluxneg']

for x in Cols:
  filenew.write(x)
  filenew.write('\t')
filenew.write('\n')

temp = ''
check = False
specals = [':','/','.','!','-','+']
c = 0
for x in data :
  if (x.isalpha() or x.isdigit() or x in specals):
    temp += x
  else :
    if temp == Cols[5]:
      check = True
    if(is_number(temp) and check):
      filenew.write(temp)
      filenew.write('\t')
      c += 1
    temp = ''
  if c == 6:
    filenew.write('\n')
    c = 0

filenew.close()

